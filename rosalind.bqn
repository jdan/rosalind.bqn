âŸ¨ Fasta, AminoOfCodon âŸ© â† â€¢Import "utils.bqn"

DNA â† +Â´=âŸœ"ACGT"Â¨
DNA "AGCTTTTCATTCTGACTGCAACGGGCAATATGTCTCTGTGTGGATTAAAAAAAGAGTGTCTGATAGCAGC"

DNA2 â† +Ë"ACGT"âŠ¸(=âŒœËœ) # can also top-left = and and Ë insert
DNA2 "AGCTTTTCATTCTGACTGCAACGGGCAATATGTCTCTGTGTGGATTAAAAAAAGAGTGTCTGATAGCAGC"

RNA â† {'T':'U';ð•©}Â¨
RNA "GATGGAACTTGACTACGTAAATT"

REVC â† âŒ½{'A':'T';'T':'A';'C':'G';'G':'C'}Â¨
REVC "AAAACCCGGT"

FIB â† { âŸ¨n,kâŸ©:
  # a, b -> b, b+k*a
  Next â† { âŸ¨ 1âŠ‘ð•©, 1âŠ‘ð•© + kÃ—âŠ‘ð•© âŸ© }
  âŠ‘ NextâŸn 0â€¿1
}
FIB 5â€¿3

GC â† {ð•Š input:
  # TODO: Parses FASTA format, used in other problems
  parsed â† Fasta input

  # Compute the GC content of a DNA string
  GCpct â† {ð•Š dna:
    gc â† +Â´ { (ð•© = 'G') âˆ¨ (ð•© = 'C') }Â¨ dna
    100Ã—gcÃ·â‰ dna
  }

  # Return the label and GC content of the DNA string
  # with the highest GC content
  labels â† âŠ‘Â¨ parsed
  gcs â† GCpctâˆ˜(1âŠ¸âŠ‘)Â¨ parsed
  maxIndex â† âŠ‘ â’ gcs

  maxIndexâŠ‘Â¨ âŸ¨ labels, gcs âŸ©
}

GC ">Rosalind_6404
CCTGCGGAAGATCGGCACTAGAATAGCCAGAACCGTTTCTCTGAGGCTTCCGGCCTTCCC
TCCCACTAATAATTCTGAGG
>Rosalind_5959
CCATCGGTAGCGCATCCTTAGTCCAATTAAGTCCCTATCCAGGCGCTCCGCCGAAGGTCT
ATATCCATTTGTCAGCAGACACGC
>Rosalind_0808
CCACCCTCGTGGTATGGCTAGGCATTCAGGAACCGGAGAACGCTTCAGACCAGCCCGGAC
TGGGAACCTGCGGGCAGTAGGTGGAAT
"

HAMM â† {âŸ¨a,bâŸ©: +Â´aâ‰ b}
HAMM "GAGCCTACTAACGGGAT"â€¿"CATCGTAATGACGGCCT"

IPRB â† {âŸ¨k,m,nâŸ©:
  +Â´ âŸ¨
    # P(kð•©) = 1
    kÃ·(k+m+n),
    # P(mk) = 1
    (mÃ·(k+m+n))Ã—kÃ·(k+m+n-1),
    # P(mm) = 3/4
    (mÃ·(k+m+n))Ã—((m-1)Ã·(k+m+n-1))Ã—3Ã·4,
    # P(mn) = 1/2
    (mÃ·(k+m+n))Ã—(nÃ·(k+m+n-1))Ã—1Ã·2,
    # P(nk) = 1
    (nÃ·(k+m+n))Ã—kÃ·(k+m+n-1),
    # P(nm) = 1/2
    (nÃ·(k+m+n))Ã—(mÃ·(k+m+n-1))Ã—1Ã·2
  âŸ©
}
IPRB 2â€¿2â€¿2

SUBS â† { âŸ¨needle,haystackâŸ©:
  len â† â‰  haystack
  matches â† needle â· haystack
  # indices of matches
  1 + (len â†‘ matches) / â†•len
}
SUBS âŸ¨"ATAT", "GATATATGCATATACTT"âŸ©

# TODO: Need double-precision numbers, bignat
# likely not the right choice.
FIBD â† {âŸ¨n,mâŸ©:
  âŸ¨AddâŸ© â† â€¢Import "bignat.bqn"
  zero â† 0 Add 0
  one â† 0 Add 1

  Next â† {ð•Š rabbits:
    newRabbits â† AddÂ´ 1â†“rabbits
    # drop the last group
    âŸ¨newRabbitsâŸ© âˆ¾ (Â¯1â†“rabbits)
  }
  # start with a single pair of 0-month
  # old rabbits, and complete the state
  # with m-1 empty age groups
  init â† âŸ¨âŸ¨oneâŸ©âŸ© âˆ¾ (m-1) / â‹ˆâ‹ˆzero
  âŠ‘ AddÂ´ NextâŸ(n-1) init
}
FIBD 52â€¿20

# P(AA Ã— AA) = 1
# P(AA Ã— Aa) = 1
# P(AA Ã— aa) = 1
# P(Aa Ã— Aa) = 3/4
# P(Aa Ã— aa) = 1/2
# P(aa Ã— aa) = 0
IEV â† {âŸ¨a,b,c,d,e,fâŸ©:(2Ã—(a+b+c))+(1.5Ã—d)+e}
IEV 18916â€¿18455â€¿17826â€¿16977â€¿19645â€¿19837  # 155504.5

LIA â† {âŸ¨k,nâŸ©:
  # The key to this problem is realizing  that no matter what genotype the
  # organism that mates with someone of genotype Aa Bb has, the probability that
  # the offspring is Aa Bb is always 0.25
  p â† 1Ã·4
  Fact â† {Ã—Â´(1+â†•ð•©)}
  Choose â† {(Fact ð•¨) Ã· ((Fact ð•©) Ã— (Fact ð•¨ - ð•©))}
  # P(r) = \binom{2^k}{r} \cdot p^r \cdot (1-p)^{2^k-r}
  PExact â† {((2â‹†k) Choose ð•©) Ã— (pâ‹†ð•©) Ã— ((1-p)â‹†((2â‹†k) - ð•©))}
  Range â† {ð•¨ + â†•(1 + ð•© - ð•¨)}
  # P(râ‰¥n) = \sum_{i=n}^{2^k} P(i)
  +Â´ PExactÂ¨ n Range 2â‹†k
}
LIA 5â€¿7

PRTM â† {ð•Š protein:
  MonoisotopicMass â† {
    'A': 71.03711;'C': 103.00919;'D': 115.02694;
    'E': 129.04259;'F': 147.06841;'G': 57.02146;
    'H': 137.05891;'I': 113.08406;'K': 128.09496;
    'L': 113.08406;'M': 131.04049;'N': 114.04293;
    'P': 97.05276;'Q': 128.05858;'R': 156.10111;
    'S': 87.03203;'T': 101.04768;'V': 99.06841;
    'W': 186.07931;'Y': 163.06333
  }
  +Â´ MonoisotopicMassÂ¨ protein
}
PRTM "SKADYEK"

PROT â† {
  âŸ¨âŸ©: âŸ¨âŸ© ;
  # TODO: Stop recursing at "*"
  ð•©: (AminoOfCodon 3â†‘ð•©) âˆ¾ ð•Š 3â†“ð•©
}
PROT "AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA"

GRPH â† {âŸ¨k, inputâŸ©:
  parsed â† Fasta input
  dnas â† 1âŠ‘Â¨ parsed
  Matches â† {
    (ð•© â‰¡ ð•¨) ? 0 ;
    ((- k)â†‘ ð•¨) â‰¡ (kâ†‘ð•©)
  }
  # adjacency table of suffix = prefix
  adj â† MatchesâŒœËœ dnas
  # turn the table into a list of edges
  MatchesForEntry â† { ð•Š n:
    others â† (n âŠ adj) / âŠ‘Â¨ parsed
    (âŠ‘nâŠ‘parsed) âŠ¸â‹ˆÂ¨ others
  }
  PrintLine â† {âŸ¨label, dnaâŸ©:
    nl â† @ + 10
    label âˆ¾ " " âˆ¾ dna âˆ¾ nl
  }
  âˆ¾Â´ PrintLineÂ¨ âˆ¾Â´ MatchesForEntryÂ¨ â†•â‰ parsed
}

GRPH 3â€¿">Rosalind_0498
AAATAAA
>Rosalind_2391
AAATTTT
>Rosalind_2323
TTTTCCC
>Rosalind_0442
AAATCCC
>Rosalind_5013
GGGTGGG
"
